---
layout: post
title: JQuery实现一个筛选数据的功能
date: 2019-09-20
author: 霁
header-img:
catalog: true
categories:
- 学习
- JavaScript
tags:
- JQuery
---

### 前言

目的为了给我的博客标签页添加按标签数据进行筛选。

基于jekyll的博客。

实现效果：

![uMZv8g.gif](https://s2.ax1x.com/2019/09/27/uMZv8g.gif)

---

### 标签页部分代码如下：

```html
<!-- 标签分类 -->
<div class="zero-filter padd-box" id="zero-filter">
    <button data-filter="*" class="active">All</button>
    {% for tag in site.tags %}
    <button data-filter=".{{ tag[0] }}">{{ tag[0] }}
        <sup style="color:red">{{tag[1].size}}</sup>
    </button>
    {% endfor %}
</div>

<!-- 标签过滤内容 -->
<div class="zero-grid" id="zero-filterItem">
<!-- 渲染具体的标签列表 -->
{% for tag in site.tags %}

<section class="zero-grid-item {{ tag[0] }}">

	<header>
		<h2 id="{{ tag[0] }}">{{ tag[0] }}</h2>
	</header>
	<!-- 渲染本标签的博文列表 -->
    {% for post in tag[1] %}
    <p>
        <a href="{{ post.url }} ">
            <span>{{ post.title }}
                <time datetime="{{ post.date | date:"%Y-%m-%d" }}">
                    <small>[{{ post.date | date:"%Y-%m-%d" }}]
                    </small>
                </time>
            </span>
        </a>
    </p>
    {% endfor %}

</section>

{% endfor %}
</div>
```



上面自定义了一个数据：data-filter = "*" ,代表所有列表都显示。data-filter=".{{ tag[0] }}" 以标签名作为要过滤的类名。

### 具体流程是这样的：

```html
1. 定义筛选数据
根据标签名生成的按钮组
data-filter=".{{ tag[0] }}"
<button data-filter=".{{ tag[0] }}">{{ tag[0] }}</button>
2. 给循环渲染出来的每个标签列表添加类名，以标签名作为类名
<section class="zero-grid-item {{ tag[0] }}">...</section>
3. 进行JQuery的筛选。
```

### 正好复习一下JQuery的遍历

```javascript
// 返回选择元素的直接子元素
children()
// 返回被选择元素的第一个元素
first()
// 返回拥有一个或多个元素在内的所有元素
has()
// 返回所选元素的直接父元素
parent()
// 根据需要匹配的选择器过滤元素返回
filter()
// 与filter相对，返回不符合的元素
not()
```

它们接受一些匹配的规则返回一些元素集合。

### 具体的实现：

```javascript
$(document).ready(function () {
    $('#zero-filter').children().click(function(){
        // 获取自定义的属性
        var data_filter = $(this).attr("data-filter");
        // 移除所有已经选择过的按钮 active
        $("#zero-filter").children().removeClass("active");
        // 如果点击的当前按钮不是所有    
        if(data_filter!=='*' && !$(this).hasClass("active")){
            // 将过滤具体的标签列表选择返回符合的项目
            // 移除隐藏的类名
            // 显示出来。
            $("#zero-filterItem")
                .children()
                .filter(data_filter)
                .removeClass("hidden")
                .fadeIn();
            /*
        不符合条件的添加隐藏的类名
        移除出去
        */
            $("#zero-filterItem")
                .children()
                .not(data_filter)
                .addClass("hidden")
                .fadeOut();
            // 给这个按钮一个激活状态    
            return $(this).addClass("active");
        }else if(data_filter==='*') {
            // 如果是全部就移除所有的隐藏显示出来
            $("#zero-filterItem")
                .children()
                .removeClass("hidden")
                .fadeIn();
            return $(this).addClass("active");
        }
});});
```

